<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="DPMM">
<title>DPMM • DPMM</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="DPMM">
<meta property="og:description" content="DPMM">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">DPMM</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.3</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/DPMM.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Worked_Examples.html">Worked Examples</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>DPMM</h1>
            
      
      
      <div class="d-none name"><code>DPMM.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>The goal of <code>DPMM</code> (Dirichlet process mixture model) is to
fit a Dirichlet Process Mixture Model to a dataset with continuous
and/or categorical predictors. The fitted model can be used for
prediction of missing predictors.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">DPMM</span><span class="op">)</span></span></code></pre></div>
<p>In here, we will discuss the functions and workflow of this
package.</p>
<div class="section level3">
<h3 id="dataset">Dataset<a class="anchor" aria-label="anchor" href="#dataset"></a>
</h3>
<p>We start with discussing the dataset we will be using. Although
several datasets are provided with the ‘DPMM’ package, we will be using
Dataset 1. Dataset 1 is comprised of two distinct clusters, where the
values of both predictor variables do not overlap each other. Therefore,
one variable is informative of the other.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">dataset_1</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">GGally</span><span class="fu">::</span><span class="fu"><a href="https://ggobi.github.io/ggally/reference/ggpairs.html" class="external-link">ggpairs</a></span><span class="op">(</span><span class="va">dataset_1</span><span class="op">)</span></span></code></pre></div>
<p><img src="DPMM_files/figure-html/unnamed-chunk-2-1.png" width="576"></p>
</div>
<div class="section level3">
<h3 id="fitting-the-dpmm-to-complete-data">Fitting the DPMM to complete data<a class="anchor" aria-label="anchor" href="#fitting-the-dpmm-to-complete-data"></a>
</h3>
<p>We can fit the DPMM to the complete dataset. The ‘mcmc_iterations’
represents how long the MCMC chain should run (longer is better), ‘L’
represents the number of clusters that should be fitted, ‘mcmc_chain’
represents the number of MCMC chains being fitted in this function and
‘standardise’ chooses whether the continuous values should be
standardised.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">posteriors</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/runModel.html">runModel</a></span><span class="op">(</span><span class="va">dataset_1</span>, </span>
<span>                       mcmc_iterations <span class="op">=</span> <span class="fl">20000</span>, </span>
<span>                       L <span class="op">=</span> <span class="fl">10</span>, </span>
<span>                       mcmc_chains <span class="op">=</span> <span class="fl">4</span>, </span>
<span>                       standardise <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; ===== Monitors =====</span></span>
<span><span class="co">#&gt; thin = 1: alpha, muL, tauL, v, z</span></span>
<span><span class="co">#&gt; ===== Samplers =====</span></span>
<span><span class="co">#&gt; RW_wishart sampler (1)</span></span>
<span><span class="co">#&gt;   - R1[1:2, 1:2] </span></span>
<span><span class="co">#&gt; RW sampler (2)</span></span>
<span><span class="co">#&gt;   - alpha</span></span>
<span><span class="co">#&gt;   - kappa1</span></span>
<span><span class="co">#&gt; conjugate sampler (29)</span></span>
<span><span class="co">#&gt;   - v[]  (9 elements)</span></span>
<span><span class="co">#&gt;   - muL[]  (10 multivariate elements)</span></span>
<span><span class="co">#&gt;   - tauL[]  (10 multivariate elements)</span></span>
<span><span class="co">#&gt; categorical sampler (1000)</span></span>
<span><span class="co">#&gt;   - z[]  (1000 elements)</span></span>
<span><span class="co">#&gt; |-------------|-------------|-------------|-------------|</span></span>
<span><span class="co">#&gt; |-------------------------------------------------------|</span></span>
<span><span class="co">#&gt; |-------------|-------------|-------------|-------------|</span></span>
<span><span class="co">#&gt; |-------------------------------------------------------|</span></span>
<span><span class="co">#&gt; |-------------|-------------|-------------|-------------|</span></span>
<span><span class="co">#&gt; |-------------------------------------------------------|</span></span>
<span><span class="co">#&gt; |-------------|-------------|-------------|-------------|</span></span>
<span><span class="co">#&gt; |-------------------------------------------------------|</span></span></code></pre></div>
<div class="section level4">
<h4 id="check-fitting-diagnostics">Check fitting diagnostics<a class="anchor" aria-label="anchor" href="#check-fitting-diagnostics"></a>
</h4>
<p>The ‘DPMM’ package provides several diagnostic tools. The function
‘plot_alpha’ takes the posterior samples from the fitted DPMM and
explores whether it shows evidence of convergence (important for
Bayesian inference). The plot is divided into three panels:</p>
<ul>
<li>A: number of components used at each iteration of the fitted
model.</li>
<li>B: average number of individuals in ranked components (after
discarding burn-in ‘nburn’, every ‘thinning’ value).</li>
<li>C: trace plot of alpha values (governs number of components).</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_alpha.html">plot_alpha</a></span><span class="op">(</span><span class="va">posteriors</span>, nburn <span class="op">=</span> <span class="fl">10000</span>, thinning <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="DPMM_files/figure-html/unnamed-chunk-4-1.png" width="960"></p>
<p>We can also check the fit of the DPMM to ensure that random samples
from the fitted DPMM are in the same covariate space as the original
data.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_ggpairs.html">plot_ggpairs</a></span><span class="op">(</span><span class="va">posteriors</span>, </span>
<span>             newdata <span class="op">=</span> <span class="va">dataset_1</span>, </span>
<span>             nburn <span class="op">=</span> <span class="fl">10000</span><span class="op">)</span></span></code></pre></div>
<p><img src="DPMM_files/figure-html/unnamed-chunk-5-1.png" width="576"></p>
</div>
<div class="section level4">
<h4 id="predictions-of-missing-values">Predictions of missing values<a class="anchor" aria-label="anchor" href="#predictions-of-missing-values"></a>
</h4>
<p>We can introduce missingness in the dataset and check whether the
DPMM is predicting values in the right cluster. In this case, we
introduce missingness in ‘X1’ for some of the patients in one of the
clusters.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rows</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">50</span></span>
<span><span class="va">dataset_missing</span> <span class="op">&lt;-</span> <span class="va">dataset_1</span></span>
<span><span class="va">dataset_missing_predict</span> <span class="op">&lt;-</span> <span class="va">dataset_missing</span><span class="op">[</span><span class="va">rows</span>,<span class="op">]</span></span>
<span><span class="va">dataset_missing_predict</span><span class="op">[</span>,<span class="st">"X1"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="cn">NA</span><span class="op">)</span></span></code></pre></div>
<p>And make predictions from the fitted DPMM.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">posteriors.prediction</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict_dpmm_fit.html">predict_dpmm_fit</a></span><span class="op">(</span><span class="va">posteriors</span>, </span>
<span>                                          newdata <span class="op">=</span> <span class="va">dataset_missing_predict</span>,</span>
<span>                                          samples <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">10000</span>,<span class="fl">20000</span>, <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>We can then check whether the values are being predicted in the right
place. First, we calculate the credible intervals for each predicted
value.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">low_q</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="va">median_q</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="va">high_q</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">posteriors.prediction</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">low_q</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">low_q</span>, <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">posteriors.prediction</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="op">]</span><span class="op">)</span>, probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">median_q</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">median_q</span>, <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">posteriors.prediction</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="op">]</span><span class="op">)</span>, probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">high_q</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">high_q</span>, <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">posteriors.prediction</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="op">]</span><span class="op">)</span>, probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.95</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>We then standardise the original values to match the standardisation
in the DPMM.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">standardised_values</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">dataset_missing</span><span class="op">[</span><span class="va">rows</span>,<span class="st">"X1"</span><span class="op">]</span><span class="op">-</span><span class="va">posteriors</span><span class="op">$</span><span class="va">mean_values</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">/</span><span class="va">posteriors</span><span class="op">$</span><span class="va">sd_values</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></code></pre></div>
<p>Lastly, we plot the credible intervals against the true values.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">standardised_values</span>,<span class="va">low_q</span>, <span class="va">median_q</span>,<span class="va">high_q</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>   <span class="fu">rlang</span><span class="fu">::</span><span class="fu"><a href="https://rlang.r-lib.org/reference/set_names.html" class="external-link">set_names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"observed"</span>, <span class="st">"low"</span>,<span class="st">"median"</span>,<span class="st">"high"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">observed</span>, y <span class="op">=</span> <span class="va">median</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html" class="external-link">geom_errorbar</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">observed</span>, ymin <span class="op">=</span> <span class="va">low</span>, ymax <span class="op">=</span> <span class="va">high</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_abline</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>intercept <span class="op">=</span> <span class="fl">0</span>, slope <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="DPMM_files/figure-html/unnamed-chunk-10-1.png" width="576"></p>
</div>
</div>
<div class="section level3">
<h3 id="fitting-the-dpmm-to-incomplete-data">Fitting the DPMM to incomplete data<a class="anchor" aria-label="anchor" href="#fitting-the-dpmm-to-incomplete-data"></a>
</h3>
<p>We can also fit the DPMM with missing data present in the original
dataset. Let’s introduce some misisngness in both clusters.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dataset_missing</span> <span class="op">&lt;-</span> <span class="va">dataset_1</span></span>
<span><span class="va">dataset_missing</span><span class="op">[</span><span class="fl">1</span>,<span class="st">"X1"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span><span class="va">dataset_missing</span><span class="op">[</span><span class="fl">501</span>,<span class="st">"X1"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span></code></pre></div>
<p>Then we fit the DPMM whilst standardising values.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">posteriors</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/runModel.html">runModel</a></span><span class="op">(</span><span class="va">dataset_missing</span>, </span>
<span>                       mcmc_iterations <span class="op">=</span> <span class="fl">20000</span>, </span>
<span>                       L <span class="op">=</span> <span class="fl">10</span>, </span>
<span>                       mcmc_chains <span class="op">=</span> <span class="fl">4</span>, </span>
<span>                       standardise <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; ===== Monitors =====</span></span>
<span><span class="co">#&gt; thin = 1: alpha, muL, tauL, v, x_cont_miss, z</span></span>
<span><span class="co">#&gt; ===== Samplers =====</span></span>
<span><span class="co">#&gt; RW_wishart sampler (1)</span></span>
<span><span class="co">#&gt;   - R1[1:2, 1:2] </span></span>
<span><span class="co">#&gt; RW sampler (2)</span></span>
<span><span class="co">#&gt;   - alpha</span></span>
<span><span class="co">#&gt;   - kappa1</span></span>
<span><span class="co">#&gt; conjugate sampler (29)</span></span>
<span><span class="co">#&gt;   - v[]  (9 elements)</span></span>
<span><span class="co">#&gt;   - muL[]  (10 multivariate elements)</span></span>
<span><span class="co">#&gt;   - tauL[]  (10 multivariate elements)</span></span>
<span><span class="co">#&gt; conditional_RW sampler (2)</span></span>
<span><span class="co">#&gt;   - x_cont_miss[1, 1:2]</span></span>
<span><span class="co">#&gt;   - x_cont_miss[2, 1:2] </span></span>
<span><span class="co">#&gt; categorical sampler (1000)</span></span>
<span><span class="co">#&gt;   - z[]  (998 elements)</span></span>
<span><span class="co">#&gt;   - zmiss[]  (2 elements)</span></span>
<span><span class="co">#&gt; |-------------|-------------|-------------|-------------|</span></span>
<span><span class="co">#&gt; |-------------------------------------------------------|</span></span>
<span><span class="co">#&gt; |-------------|-------------|-------------|-------------|</span></span>
<span><span class="co">#&gt; |-------------------------------------------------------|</span></span>
<span><span class="co">#&gt; |-------------|-------------|-------------|-------------|</span></span>
<span><span class="co">#&gt; |-------------------------------------------------------|</span></span>
<span><span class="co">#&gt; |-------------|-------------|-------------|-------------|</span></span>
<span><span class="co">#&gt; |-------------------------------------------------------|</span></span></code></pre></div>
<div class="section level4">
<h4 id="check-fitting-diagnostics-1">Check fitting diagnostics<a class="anchor" aria-label="anchor" href="#check-fitting-diagnostics-1"></a>
</h4>
<p>We can do the same diagnostic checks. First the alpha values.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_alpha.html">plot_alpha</a></span><span class="op">(</span><span class="va">posteriors</span>, nburn <span class="op">=</span> <span class="fl">10000</span>, thinning <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="DPMM_files/figure-html/unnamed-chunk-13-1.png" width="960"></p>
<p>Then comparing the DPMM against the original dataset.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_ggpairs.html">plot_ggpairs</a></span><span class="op">(</span><span class="va">posteriors</span>, </span>
<span>             newdata <span class="op">=</span> <span class="va">dataset_1</span>, </span>
<span>             nburn <span class="op">=</span> <span class="fl">10000</span><span class="op">)</span></span></code></pre></div>
<p><img src="DPMM_files/figure-html/unnamed-chunk-14-1.png" width="576"></p>
</div>
<div class="section level4">
<h4 id="imputation-of-missing-values">Imputation of missing values<a class="anchor" aria-label="anchor" href="#imputation-of-missing-values"></a>
</h4>
<p>We can check how well are those missing values being imputed during
the model fitting. Here, we are only checking chain 1, but it can be
repeated for all other chains.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">intercept_1</span> <span class="op">=</span> <span class="op">(</span><span class="va">dataset_1</span><span class="op">[</span><span class="fl">1</span>,<span class="st">"X1"</span><span class="op">]</span><span class="op">-</span><span class="va">posteriors</span><span class="op">$</span><span class="va">mean_values</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">/</span><span class="va">posteriors</span><span class="op">$</span><span class="va">sd_values</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="va">posteriors</span><span class="op">$</span><span class="va">samples</span><span class="op">$</span><span class="va">chain1</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>                     <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">`x_cont_miss[1, 1]`</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>                     <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice</a></span><span class="op">(</span><span class="fl">10000</span><span class="op">:</span><span class="fl">20000</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>                     <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">intercept_1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="DPMM_files/figure-html/unnamed-chunk-15-1.png" width="576"></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">intercept_2</span> <span class="op">=</span> <span class="op">(</span><span class="va">dataset_1</span><span class="op">[</span><span class="fl">501</span>,<span class="st">"X1"</span><span class="op">]</span><span class="op">-</span><span class="va">posteriors</span><span class="op">$</span><span class="va">mean_values</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">/</span><span class="va">posteriors</span><span class="op">$</span><span class="va">sd_values</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="va">posteriors</span><span class="op">$</span><span class="va">samples</span><span class="op">$</span><span class="va">chain1</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>                     <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">`x_cont_miss[2, 1]`</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>                     <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice</a></span><span class="op">(</span><span class="fl">10000</span><span class="op">:</span><span class="fl">20000</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>                     <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">intercept_2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="DPMM_files/figure-html/unnamed-chunk-15-2.png" width="576"></p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by .</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
